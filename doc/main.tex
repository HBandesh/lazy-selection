\documentclass[12pt,a4paper]{article}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[margin=2.5cm]{geometry}
\usepackage{graphicx}
\usepackage[hidelinks]{hyperref}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{appendix}
\usepackage{mdframed}
\usepackage{color}
\usepackage{palatino}
\usepackage{mathtools}
\usepackage{changepage}
\usepackage{subcaption}
\usepackage{enumitem}
\usepackage{csquotes}
\usepackage{verbatim}
\usepackage[cache=false]{minted}
\usepackage[ruled,vlined]{algorithm2e}

\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

\usemintedstyle{default}
\setminted{
  linenos=true,
  breaklines=true,
  fontsize=\small,
  frame=single,
}

\title{Lazy Selection}
\author{Carlos Requena LÃ³pez}

%% Fancy layout
\pagestyle{fancy}
\lhead{Lazy selection}
\chead{}
\rhead{}
\lfoot{}
\cfoot{}
\rfoot{Page \thepage\ of \pageref{LastPage}}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

\newtheorem{theorem}{Theorem}


%%% --- %%% --- DOCUMENT START --- %%% --- %%%
\begin{document}
\maketitle
\pagestyle{fancy}

\section{Introduction}

This assignment tries to empirically verify Theorem 3.5 (here
\ref{theo1}) from \cite[p.~49]{motwani}, running the
\textbf{LazySelect} algorithm for different values of $n$ and $k$ to
establish the asymptotic behaviour of the number of comparisons
performed.

The \textbf{LazySelect} algorithm finds the $k$th smallest element in
a set $S$ (assumed to have a total order) of size $n$. It is
essentially outputs the element with rank $k$. Concerning notation,
$A_{(i)}$ will refer to the element with rank $i$ in set $A$ and
$r_A(j)$ will refer to the rank of element $j$ in set $A$.
\section{Analysis and expectations}

We detail the steps of the aforementioned algorithm in Algorithm
\ref{algo:lazyselect}.

\begin{algorithm}[h]
  \SetAlgoLined
  \KwIn{An (unsorted) array $S$ of size $n$ and and integer $k < n$}
  \KwOut{The element in $S$ that has rank $k$}

  \nl Take a random sample of $n^{3/4}$ elements of S. Call it $R$\;
  \nl Sort R\;
  \nl Define $x = kn^{-1/4}$. With $\ell = \text{max}\{\floor{x -
    \sqrt{n}}, 1\}$ and $h = \text{min}\{\ceil{x - \sqrt{n}\ \ }, n^{3/4}\}$\;
  \nl Assign $a = R_{(\ell)}$ and $b = R_{(h)}$\;
  \nl Determine the rank of $a$ and $b$ in $S$. That is, find $r_{S}(a)$
  and $r_{S}(b)$\;
  \nl \uIf{$k < n^{1/4} $}{$P = \{y \in S\ |\ y \leq b\}$}
  \uElseIf{$k > n - n^{1/4}$}{$P = \{y \in S\ |\ y \geq a\}$}
  \ElseIf{$k \in [n^{1/4}\, n - n^{1/4}]$}{$P = \{y \in S\ |\ a \leq y
    \leq b\}$}
  \nl Check whether $S_{(k)} \in P$ \emph{and} $|P| \leq 4n^{3/4} +
  2$. If not, repeat steps 1 through 6\;
  \nl If the conditions are satisfied: sort $P$ and look for $S_{(k)}$
  in $P$\;
\caption{\bf LazySelect}
\label{algo:lazyselect}
\end{algorithm}

We can make a few observations about this algorithm:
\begin{itemize}
\item By taking $R$, we hope it will be a good representative of the
  original set $S$.
\item Any optimal sorting algorithm works for step 2. The number of
  comparisons performed is sublinear: $\mathcal{O}(n^{3/4}\log(n))$
\item l and j
\end{itemize}

Also, as proved in \cite[p.~49]{motwani}, we have:

\begin{mdframed}
  \begin{theorem}
    With probability $1 - \mathcal{O}(n^{-1/4})$,
    \textbf{\textup{LazySelect}} finds $S_{(k)}$ on the first pass,
    and thus performs only $2n + o(n)$ comparisons.
    \label{theo1}
  \end{theorem}
\end{mdframed}


The elements are put back to simplify the analysis, since the random
variables used become independent.

$x$ is a sort of rank scaling. Rank $x$ is to $R$ what $k$ is to $S$
(roughly).

% \cite[p.~50]{motwani}



\section[Implementation]{Implementation}

% \footnote{Code can be found at
%   \url{https://github.com/carlosgeos/bspace-part}}\footnote{An
%   executable \texttt{.jar} file can be downloaded from
%   \url{https://github.com/carlosgeos/bspace-part/releases}}

% \ref{fig:sample-input}

% \begin{figure}[ht!]
%   \centering
%   \includegraphics[width=0.7\textwidth]{img/sample-input.png}
%   \caption{Five random segments on a 720x720 canvas}
%   \label{fig:sample-input}
% \end{figure}

\section{Results}

\section{Conclusion}

\nocite{*}
\bibliographystyle{plain}
\bibliography{refs}


\appendix
\section{Appendix - code listing}

\inputminted[label=core.clj]{clojure}{../src/lazy_selection/core.clj}
% \inputminted[label=geometry.clj]{clojure}{../src/bspace_part/geometry.clj}
% \inputminted[label=core.clj]{clojure}{../src/bspace_part/core.clj}

\end{document}
